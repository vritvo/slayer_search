from utils.models import tag_text

if __name__ == "__main__":
    input_text = """
    (Cut to a playground, daylight. Giles and Spike are swinging on swings, both dressed in Giles-type tweeds. Buffy playing in the sandbox.)

(Xander walks up.)

XANDER
Hey, there you are.

BUFFY
(putting sand in pail with plastic shovel) Are you sure it's us you were looking for?

(Giles smiles at her.)

SPIKE
Giles here is gonna teach me to be a Watcher. Says I got the stuff.

GILES
Spike's like a son to me. (They both smile and continue swinging)

XANDER
That's good. I was into that for a while, but... (nods toward the street) I got other stuff goin' on.

(Long shot of the ice-cream truck surrounded by kids.)

(Closer shot of Xander in the truck, wearing his striped shirt and hat, serving ice cream to kids.)

XANDER
(in playground) You gotta have something. (Looks at Buffy) Gotta be with movin' forward.

BUFFY
(like a proud little kid) Like a shark.

XANDER
Like a shark with feet and ... much less fins.

SPIKE
(like a proud little kid) And on land!

GILES
Very good!

(They keep swinging.)

XANDER
Buffy, are you sure you wanna play there?

(Buffy gives him a pouty look like a little kid told not to do something.)

XANDER
It's a pretty big sandbox.

BUFFY
I'm okay. (Suddenly we see her against the backdrop of the desert from Willow's dream. Rocks, sand, scraggly trees) It's not coming for me yet.

XANDER
I just mean ... you can't protect yourself from ... some stuff.

(Buffy looks directly at him. The playground backdrop is back.)

BUFFY
I'm way ahead of you, big brother.

XANDER
Brother?

(Buffy looks at him expressionless. Soft music: a woman vocalizing without words.)

(Spike and Giles swinging higher and higher.)

GILES
Go on, put your back into it! A Watcher scoffs at gravity. (They continue swinging. Woman continues humming.)

(Shot of Buffy still expressionless.)

(Shot of Xander squinting at her.)

(Shot of the other Xander in the truck, watching them.)

(Shot of the four of them from the truck-Xander's perspective.)

(Truck-Xander pulls back from the window, goes to the wheel, although the truck is already in motion: tree-lined streets going by. Anya is sitting in the passenger seat doing something with her hands.)

(Xander sits in the driver's seat. Anya looks at him.)

ANYA
Do you know where you're going?

(Xander looks at her, surprised.)

ANYA
I've been thinking about getting back into vengeance.

(We see her playing with a lollipop in its wrapper.)

(Xander takes his striped hat off, puts it on the dashboard.)

XANDER
Is that right?

ANYA
Well, you know how I miss it. I'm so at loose ends since I quit. I

think this is going to be a very big year for vengeance.

XANDER
But ... isn't vengeance kind of ... vengeful?

ANYA
(petulant) You don't want me to have a hobby.

XANDER
Not a vengeance hobby, no! It's dangerous. People can't do anything they want. Society has rules, and borders, and an end zone. It doesn't matter if-

(He hears giggling, turns.)

(We see Willow and Tara in the back of the truck, snuggling and nuzzling.

Both wearing exaggerated eye makeup.)

XANDER
Do you mind? I'm talking to my demon.

(Shot of Willow in a very short black bustier, Tara in a short black skirt and very revealing white blouse. Tara has one leg bent and Willow's hand is on her thigh. Both have heavy black eye makeup and thick red lipstick.)

WILLOW
Sorry.

(Xander stares at them. Both girls smile seductively at him. We hear Tara's voice although her lips don't move.)

TARA
We just think you're really interesting.

XANDER
Oh, I-I'm going places.

WILLOW
I'm way ahead of you. (Caressing Tara's leg.)

(Closeup of Willow and Tara grinning at each other, nuzzling. Willow whispers in Tara's ear. They both giggle.)

(Pan down to Willow's hand stroking Tara's thigh.)

XANDER
(riveted) Is that right?

(They look at him.)

WILLOW
Watch this.

(Willow puts her hand on Tara's waist. Tara puts her hand on Willow's shoulder. They lean toward each other.)

(Shot of Xander's wide-eyed face. We hear kissing noises and soft moans.

Extended shot of Xander staring.)

TARA
Do you wanna come in the back with us?

(Xander stares open-mouthed.)

ANYA
Oh, go on.

(Xander stares at her. Sexy music starts.)

XANDER
I don't have to.

ANYA
I'll be fine. I think I've figured out how to steer by gesturing emphatically.

(Xander looks at the road, looks at Anya, looks back. Gets up.)

(Shot of Anya gesturing emphatically at the road.)

(Xander walks past the ice-cream-selling window in the side of the truck.

Outside, we see more tree-lined streets rushing by. The girls are gone.)

(Xander walks to the back of the truck, climbs up onto a loft-like thing, past a big pile of newspapers and other random debris. He shoves a cooler out of the way, falls down onto the floor in his basement. Looks around, exasperated.)

XANDER
Girls?

(The upstairs doorknob begins rattling again. Xander walks forward nervously. Suddenly there's pounding on the door too. He looks up, scared.)

XANDER
(yells) I know what's up there!

(Pounding continues. He backs away, turns, sees the bald man holding up a plate of cheese slices.)

BALD MAN
These ... will not protect you.

(More pounding, growling. Xander goes past the bald man and out the back door.)

(Xander is in the Sunnydale High hallways, but the colors are all weird.

Everything's purple and green. Weird noises like microphone feedback.

Xander pushes his way past students talking in the halls. Looking over his shoulder, he can maybe see something through the other students' legs, chasing him.)

XANDER
Giles.

(Giles is leaning against a wall, dressed casually, holding an apple.)

GILES
Xander, what are you doing here?

XANDER
What's after me?

GILES
It's because of what we did, I know that. (Takes a bite of the apple)

XANDER
(shakes his head in confusion) What we did?

GILES
Hm. Now, the others have gone on ahead. (Points down the hall.) Now, listen very carefully. Your life may depend on what I'm about to tell you.

You need-

(Giles' voice changes to a man speaking French. Sounds like the voice on a tape in a beginning language class. Giles continues talking and gesturing, but what we hear is the French.)

GILES
(French)

XANDER
What? Go where? I don't understand.

GILES
(?) Ce n'est pas le temps pour des jeux. [This is not the time for games.]

(Anya approaches.)

ANYA
Xander. (Fake French woman's voice) Il faut que tu viens avec nous maintenant. On t'attends. [You have to come with us now. They're waiting for you.]

GILES
C'est que j'ai vous dire. [That's what I said.]

XANDER
Honey, I don't... I can't hear you.

(Anya takes his hand.)

ANYA
C'est pas importante. Je t'escorte. [It's not important. I'll take you.]

GILES
Allons-y la. [Let's go.]

(Giles also takes Xander's hand, trying to pull him down the hall. A random guy goes by on a skateboard, pushes Xander down the hall)

XANDER
W-wait! Where we going? Where? (Looks over his shoulder as they pull/push him down the hall. Struggles.) Hey! (People in the crowd pick him up. In the crowd we can still see Giles with the apple in his mouth.) Let go! Hey! (The final "Hey" echoes.)

(Fade to Xander in green army fatigues, hands cuffed behind his back, moving through a forest. Asian-type music. Another guy in fatigues, holding a gun, is guarding him. An image of Xander's face is overlaid over the left half of the screen.)

(Fade to a dark room lit with red lights. Soldiers bring Xander in and he kneels. There's a cot at the right with a person on it.)

MALE VOICE
Where are you from, Harris?

XANDER
Well, the basement, mostly.

MALE VOICE
Were you born there?

(Camera moving toward the person on the cot.)

(Shot of Xander looking toward the cot, a soldier guarding him in the background. Xander nods.)

XANDER
Possibly.

VOICE
I walked by your guidance counselor's office one time.

(The person sits up partway and we see it's Principal Snyder, with a towel around his neck.)

SNYDER
A bunch of you were sitting there ... waiting to be shepherded.

(Xander looks confused, alarmed.)

SNYDER
I remember it smelled like dead flowers. Like decay. Then it hit me. The hope of our nation's future is a bunch of mulch.

XANDER
You know, I never got the chance to tell you how glad I was you were eaten by a snake. (Suddenly gets an "I shouldn't have said that" look on his face)

(Snyder sits up slowly. His face is all sweaty.)

SNYDER
Where are you heading?

XANDER
(shrugs uncertainly) Well, I'm supposed to meet Tara and Willow.

(Shot of hands lifting a wooden bowl.)

XANDER
And possibly Buffy's mom.

(Snyder's hands lifting water from the bowl and pouring it over his bald head.)

SNYDER
Your time is running out.

XANDER
No, I'm just trying to get away. There's ... something I can't fight.

SNYDER
Are you a soldier?

XANDER
(shakes head) I'm a comfortador.

(Snyder leans forward so his face is illuminated.)

SNYDER
(contemptuous) You're neither. You're a whipping boy. Raised by mongrels and set on a sacrificial stone.

XANDER
(nods) I'm getting a cramp.

(He stands, looks around. He's somewhere else. Around a corner we see the same dark-haired person/creature that previously attacked Willow. It's crawling or crouching behind a trellis. It growls. Xander backs away. We see he's in the courtyard outside Giles' apartment. He runs to Giles' door, opens it, enters.)

XANDER
Giles, it's here!

GILES
It's more serious than we thought.

(We see Giles and Buffy and Anya looking at Willow, who's in a chair still gasping and choking. They all ignore Xander. We hear what sounds like helicopter noises.)

XANDER
Giles!

BUFFY
I can fight anything. Right?

ANYA
Maybe we should slap her.

(Xander runs past them, down the hall that should lead to Giles' kitchen, but instead he comes out in Buffy's dorm. Students walking around, chattering. Harsh, jangly rock music with the helicopter noise as the percussion. Xander goes through the hallways and into Buffy and Willow's room.)

XANDER
Buffy?

(Hears growling behind him. He yanks open the closet door and goes in.

Fights his way past the clothes and is in a dark room, horizontal-striped light like it's coming through Venetian blinds. He runs through dark brick-lined hall, comes out in his basement again. Stops, looks around. The music slowly fades out. There's still pounding on the upstairs door and the knob rattling. He goes toward it, up a couple of stairs, shaking his head.)

XANDER
(whispers) That's not the way out. (The door bursts open. Xander looks down at himself, then back up the stairs.)

VOICE
What the hell is wrong with you?

(Xander looks chastised.)

(We see a man silhouetted in the doorway above. It's Xander's dad.)

DAD
You won't come upstairs? What are you ... ashamed of us? Your mother's crying her guts out!

XANDER
You don't understand.

DAD
No. You don't understand. (Starts down the stairs, stomping angrily)

The line ends here with us, and you're not gonna change that.

(Xander looking down, unable to look at his dad.)

DAD
You haven't got the heart.

(Suddenly Dad shoves his hand into Xander's chest. Xander looks down. The hand is covered with rags. He looks up, scared. We get a brief glimpse of a pair of feral eyes surrounded by dark stringy hair. Grey skin. The person growls.)

(The hand pulls Xander's heart out of his chest.)
    """
    result = tag_text(input_text=input_text, generate_html=True)

    # print the location_descr and extraction_text for each extraction
    for extraction in result:
        location_descr = (
            extraction.attributes.get("location_descr", "N/A")
            if extraction.attributes
            else "N/A"
        )
        print("Location Description: ", location_descr)
        print("Extraction Text: ", extraction.extraction_text)
        print("--------------------------------")
